import{i as H,t as J,h as K,Z as W,f as ee,Y as te,o as ae,a0 as le}from"./vant-BjNCsb4u.js";import{r as p,e as ne,b3 as T,aX as N,al as P,N as a,bA as m,F as z,u as n,i as c,Q as E,R as G,am as i,be as U,b1 as oe,a_ as se,aY as ie}from"./@vue-ts87NNlE.js";import{d as R}from"./dayjs-DWD9bsSZ.js";import{_ as re,h as Q,t as X}from"./index-DoomjHTc.js";import{q as Z}from"./queryUrl-BTYYWpY7.js";import{l as D}from"./lodash-DhpMPSDc.js";import"./@vant-NmgEisJw.js";import"./@vue-office-GFDCm3nC.js";import"./vue-demi-BEcyFcst.js";import"./vue-RHKPHaPZ.js";import"./pinia-B_HOjTBS.js";import"./vue-router-Bw4qQE88.js";import"./@vueuse-QQdVrKV8.js";import"./xe-utils-DXe260hc.js";import"./axios-B4uVmeYG.js";import"./@x-ui-vue3-CwLx_scX.js";import"./pinia-plugin-persist-J3Q2VqHx.js";import"./vue3-menus-CnNWMJEM.js";import"./vue3-photo-preview-CkWuweRQ.js";import"./vxe-table-QgdefRjh.js";import"./dom-zindex-GlLoxNk1.js";const q=j=>(se("data-v-21d545db"),j=j(),ie(),j),ue=q(()=>i("p",{class:"font-bold text-[16px]"},"数据总览",-1)),de={class:"grid grid-cols-2 yCenter bg-[#fef2d9] mx-[20px] rounded gap-x-[20px] justify-between px-[30px] h-[40px]"},pe=q(()=>i("div",{class:"text-[#868e96]"},"已并网",-1)),me={class:"text-[20px] text-[#232323] flex"},ce={class:"mr-[10px]"},fe={class:"grid grid-cols-2 px-[50px] gap-x-[20px] gap-y-[10px] my-[10px]"},ve={class:"text-[14px] text-[#868e96]"},xe={class:"text-[20px] flex"},be={class:"mr-[10px]"},ge=q(()=>i("p",{class:"font-bold text-[16px]"},"组织排名",-1)),f="YYYY-MM-DD",we={__name:"dataRank",setup(j){const _=p("全部"),S=p(""),x=p(!1),y=p(!1),A=p([]),h=p("全部"),B=p(""),b=p(!1),V=p(!1),g=p([]),w=R(),F=[{text:"全部",value:"全部",time:[]},{text:"当天",value:"当天",time:[w.format(f),w.format(f)]},{text:"近三天",value:"近三天",time:[w.subtract(3,"day").format(f),w.format(f)]},{text:"近七天",value:"近七天",time:[w.subtract(7,"day").format(f),w.format(f)]},{text:"自定义",value:"自定义",time:["",""]}];async function $(l,e){l+=" 00:00:00",e+=" 23:59:59";const{data:u}=await Q.get(Z("/bi/company-statistics-chart",l.length>18?{startDate:l,endDate:e}:{})),r=s=>{const v=X(s);return v.realValue+" "+v.unit};A.value=u.map(s=>({...s,signedCapacity:r(s.signedCapacity),scannedCapacity:r(s.scannedCapacity),buildingCapacity:r(s.buildingCapacity),gridConnectionCapacity:r(s.gridConnectionCapacity)}))}async function L(l,e){l+=" 00:00:00",e+=" 23:59:59";const u=l.length>18?{startDate:l,endDate:e}:{},r=["签约量","扫码量","建设中","待建设","已并网"],s=["bi/signed","bi/zujian-scanned","bi/project-building","bi/project-waiting-build","bi/grid-connection"].map(d=>Z(d,u)),v=await Promise.all(s.map(d=>Q.get(d)));g.value=v.map((d,C)=>{const o={title:r[C]},Y=D.get(d,"data");if(D.isUndefined(Y))o.value="请求失败";else{const k=X(Y,2);o.value=k.result,o.realValue=k.realValue,o.unit=k.unit}return o});const I=["已并网","签约量","扫码量","建设中","待建设"];g.value=D.sortBy(g.value,d=>I.findIndex(C=>C==d.title))}function M(l){if(D.isArray(l)){const e=l.map(u=>R(u).format(f));S.value=e.join(" 至 "),y.value=!1,$(...e)}else{const e=l.selectedOptions[0];_.value=e.value,x.value=!1,$(...e.time)}}function O(l){if(D.isArray(l)){const e=l.map(u=>R(u).format(f));B.value=e.join(" 至 "),V.value=!1,L(...e)}else{const e=l.selectedOptions[0];h.value=e.value,b.value=!1,L(...e.time)}}return ne(()=>{$(),L()}),(l,e)=>{const u=J,r=K,s=W,v=ee,I=te,d=ae,C=H,o=T("vxe-column"),Y=le,k=T("vxe-table");return N(),P(z,null,[a(C,{inset:"",class:"!mt-2"},{default:m(()=>[a(d,{valueClass:"flex justify-end",titleClass:"h-9 yCenter !flex-none",class:"!px-[20px]"},{title:m(()=>[a(u,{name:"chart-trending-o",class:"bg-[#ffab30] text-white rounded-full p-[3px] !text-[18px] mr-1"}),ue]),value:m(()=>[a(r,{modelValue:n(h),"onUpdate:modelValue":e[0]||(e[0]=t=>c(h)?h.value=t:null),isLink:"",readonly:"",onClick:e[1]||(e[1]=t=>b.value=!0),border:!1,class:"!w-[auto] max-w-[25%]","input-align":"right"},null,8,["modelValue"]),a(v,{show:n(b),"onUpdate:show":e[3]||(e[3]=t=>c(b)?b.value=t:null),position:"bottom"},{default:m(()=>[a(s,{columns:F,onConfirm:O,onCancel:e[2]||(e[2]=t=>b.value=!1)})]),_:1},8,["show"]),E(a(r,{modelValue:n(B),"onUpdate:modelValue":e[4]||(e[4]=t=>c(B)?B.value=t:null),placeholder:"请选择日期",isLink:"",readonly:"",onClick:e[5]||(e[5]=t=>V.value=!0),border:!1,"input-align":"center",class:"ml-1"},null,8,["modelValue"]),[[G,n(h)=="自定义"]]),a(I,{show:n(V),"onUpdate:show":e[6]||(e[6]=t=>c(V)?V.value=t:null),type:"range",onConfirm:O,"min-date":new Date(2010,1,1)},null,8,["show","min-date"])]),_:1}),i("div",de,[pe,i("div",me,[i("div",ce,U(n(g)[0]?.realValue),1),i("div",null,U(n(g)[0]?.unit),1)])]),i("div",fe,[(N(!0),P(z,null,oe(n(g).slice(1),t=>(N(),P("div",{key:t.title},[i("div",ve,U(t.title),1),i("div",xe,[i("div",be,U(t.realValue),1),i("div",null,U(t.unit),1)])]))),128))])]),_:1}),a(C,{inset:"",class:"!mt-2"},{default:m(()=>[a(d,{valueClass:"flex justify-end",titleClass:"h-9 yCenter !flex-none",class:"!px-[20px]"},{title:m(()=>[a(u,{name:"chart-trending-o",class:"bg-[#ffab30] text-white rounded-full p-[3px] !text-[18px] mr-1"}),ge]),value:m(()=>[a(r,{modelValue:n(_),"onUpdate:modelValue":e[7]||(e[7]=t=>c(_)?_.value=t:null),isLink:"",readonly:"",onClick:e[8]||(e[8]=t=>x.value=!0),border:!1,class:"!w-[auto] max-w-[25%]","input-align":"right"},null,8,["modelValue"]),a(v,{show:n(x),"onUpdate:show":e[10]||(e[10]=t=>c(x)?x.value=t:null),position:"bottom"},{default:m(()=>[a(s,{columns:F,onConfirm:M,onCancel:e[9]||(e[9]=t=>x.value=!1)})]),_:1},8,["show"]),E(a(r,{modelValue:n(S),"onUpdate:modelValue":e[11]||(e[11]=t=>c(S)?S.value=t:null),placeholder:"请选择日期",isLink:"",readonly:"",onClick:e[12]||(e[12]=t=>y.value=!0),border:!1,"input-align":"center",class:"ml-1"},null,8,["modelValue"]),[[G,n(_)=="自定义"]]),a(I,{show:n(y),"onUpdate:show":e[13]||(e[13]=t=>c(y)?y.value=t:null),type:"range",onConfirm:M,"min-date":new Date(2010,1,1)},null,8,["show","min-date"])]),_:1}),a(k,{data:n(A),align:"center","header-align":"center","max-height":"520",stripe:""},{default:m(()=>[a(o,{type:"seq",width:"70",title:"序号"}),a(o,{title:"组织名称",width:"200"},{default:m(({row:t})=>[a(Y,{text:t.companyName,color:"#1f1f1f",speed:"15"},null,8,["text"])]),_:1}),a(o,{field:"orderCount",sortable:"",title:"累计订单",width:"100"}),a(o,{field:"signedCapacity",sortable:"",title:"签约量",width:"100"}),a(o,{field:"scannedCapacity",sortable:"",title:"扫码量",width:"100"}),a(o,{field:"buildingCapacity",sortable:"",title:"建设量",width:"100"}),a(o,{field:"gridConnectionCapacity",sortable:"",title:"并网量",width:"100"})]),_:1},8,["data"])]),_:1})],64)}}},Me=re(we,[["__scopeId","data-v-21d545db"]]);export{Me as default};
