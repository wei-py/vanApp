import{D as L,C as z,p as F,j as G,r as P,B as K,o as M}from"./vant-xiv0EFx3.js";import{X,Q as q,u as e,aX as i,aj as T,bA as d,al as x,am as s,be as n,N as f,bD as A,V as c,F as k,b1 as $,G as O,r as _,e as Q,i as N}from"./@vue-BHA94vdH.js";import{a as b,l as R}from"./lodash-C1iNKp1x.js";import{p as U}from"./plainButton-DSPJKsXh.js";import{b as H,m as J,_ as W,c as Y,h as j}from"./index-BiU8ePZK.js";import{q as Z}from"./queryUrl-CUkA5NKU.js";import"./@vant-BMzV8Unt.js";import"./dayjs-19KvoO9f.js";import"./pinia-BOLtM30a.js";import"./vue-demi-Dq6ymT-8.js";import"./vue-router-BQWAt7JZ.js";import"./@vueuse-BYPNFz0v.js";import"./xe-utils-D22uZPtC.js";import"./axios-B6xwUs71.js";import"./@x-ui-vue3-DYFNhZJM.js";import"./pinia-plugin-persist-J3Q2VqHx.js";import"./vue3-menus--RpDJ8QK.js";import"./vue3-photo-preview-Byv7Qnko.js";import"./vxe-table-CbQjGgi9.js";import"./dom-zindex-GlLoxNk1.js";const tt={class:"flex h-auto items-center pt-[1px]"},et={class:"min-w-4 px-1 h-4 ml-2 text-sm shadowC flex items-center justify-center text-white rounded-full bg-[#ffab30]"},st={class:"mx-2"},at={class:"flex-1 justify-end pr-1 flex"},ot={class:"px-4 text-[14px] pb-[5px]"},nt={class:"font-bold"},lt=s("br",null,null,-1),rt=s("br",null,null,-1),it=s("br",null,null,-1),ct=s("br",null,null,-1),dt=s("br",null,null,-1),ut={__name:"card",props:["item"],setup(V){const t=V,v=H(),l=J();function u(o){const p=l[o.taskId]||l[o.stageId]||"-",m=l[o.stateId]||"-";return`${p} - ${m}`}return(o,p)=>{const m=L,w=z,y=X("skeleton-item"),S=X("skeleton");return q((i(),T(w,{inset:"",class:"p-1 !mb-2 shadowC van-haptics-feedback !rounded-xl"},{default:d(()=>[q((i(),x("div",null,[s("div",tt,[s("div",et,n(t.item.index),1),s("div",st,n(t.item.orderBase.orderId),1),f(U,{class:"!h-[18.7px]",onClick:p[0]||(p[0]=A(h=>o.$copyText(t.item.orderBase.orderId),["stop"]))},{default:d(()=>[c("复制")]),_:1}),s("div",at,[f(U,{onClick:A(()=>{},["stop"]),class:"!h-[18.7px]"},{default:d(()=>[c("状态")]),_:1})])]),f(m,{class:"!my-1"}),s("article",ot,[s("div",nt,n(e(b.get)(t.item,"customer.name")||e(b.get)(t.item,"customerOrg.orgName")),1),c(" 进件编号: "+n(e(b.get)(t.item,"leaseReview.contractNumber","-")),1),lt,c(" 当前阶段: "),rt,(i(!0),x(k,null,$(t.item.currentOrderState,h=>(i(),x("div",{key:h,class:O(`text-${o.$statusColor(e(l)[h.stateId])}`)},n(u(h)),3))),128)),c(" 销售人员: "+n(e(b.get)(t.item,"orderBase.salesman","-"))+" ",1),it,c(" 详细地址: "+n(e(b.get)(t.item,"orderBase.installationAddress","-"))+" ",1),ct,c(" 订单创建时间: "+n(e(b.get)(t.item,"orderBase.createTime","-"))+" ",1),dt])])),[[y]])]),_:1})),[[S,e(v).overlayShow]])}}},pt={class:"yCenter"},mt={class:"xCenter"},_t={class:"xCenter"},ft={__name:"designChange",setup(V){const t=_("");Y();const v=_(""),l=_([{taskId:"TASK_CSPSXX_UPDATE",stateName:"设计变更",count:0},{taskId:"TASK_CSPSXX",stateName:"一键变更",count:0}]),u=_({pageNum:1,pageSize:10,total:0}),o=_(!1),p=_(!1),m=_([]);function w(){}async function y(){const{data:g}=await j.get("design/record-count");l.value[1].count=g[0].count,l.value[0].count=g[1].count}const S=R.debounce(h,300);async function h(){const g={...l.value[v.value],queryTag:t.value,stageId:"DESIGN"},{data:r}=await j.post(Z("/order/search-exclude-states",u.value),g),C=r.total;u.value.total=C;const I=r.list.map((B,D)=>({...B,index:m.value.length+D+1}));m.value.push(...I),o.value=!1,p.value=u.value.pageNum*u.value.pageSize>C,u.value.pageNum++}return Q(()=>{}),(g,r)=>{const C=K,I=F,B=M,D=G,E=P;return i(),x(k,null,[f(I,{modelValue:e(t),"onUpdate:modelValue":r[0]||(r[0]=a=>N(t)?t.value=a:null),shape:"round",background:"#f3f3f3",placeholder:"系统编号、进件编号、组织全称、姓名、手机号","show-action":""},{action:d(()=>[s("div",pt,[f(C,{onClick:w,class:"!w-auto !h-[34px] shadow !px-[15px] !rounded-full !border-none !bg-[#ffab30] !text-white"},{default:d(()=>[c(" 搜索 ")]),_:1})])]),_:1},8,["modelValue"]),f(D,{active:e(v),"onUpdate:active":r[1]||(r[1]=a=>N(v)?v.value=a:null),"line-width":"0",ellipsis:!1,"title-active-color":"#ffab30",onChange:y},{default:d(()=>[(i(!0),x(k,null,$(e(l),a=>(i(),T(B,null,{title:d(()=>[s("div",mt,n(a.count),1),s("div",_t,n(a.stateName),1)]),_:2},1024))),256))]),_:1},8,["active"]),f(E,{loading:e(o),"onUpdate:loading":r[2]||(r[2]=a=>N(o)?o.value=a:null),finished:e(p),"finished-text":"没有更多了",onLoad:e(S),class:"!pt-2"},{default:d(()=>[(i(!0),x(k,null,$(e(m),a=>(i(),T(ut,{key:a.orderBase.orderId,onClick:vt=>g.$router.push({path:"/itemDetail",query:{orderId:a.orderBase.orderId}}),item:a},null,8,["onClick","item"]))),128))]),_:1},8,["loading","finished","onLoad"])],64)}}},jt=W(ft,[["__scopeId","data-v-3218b4cb"]]);export{jt as default};
