import{t as z,i as O,u as U,m as R,w as F,B as G,r as K,z as M}from"./vant-Ckwj66YG.js";import{X as E,Q as L,u as t,aX as d,aj as $,bA as h,al as b,am as e,be as a,N as f,bD as Q,V as A,F as S,b1 as V,G as Y,a_ as H,aY as J,r as v,e as W,i as D}from"./@vue-ts87NNlE.js";import{a as p,l as Z}from"./lodash-DhpMPSDc.js";import{p as ee}from"./plainButton-BYjUyjhC.js";import{_ as X,b as te,n as se,c as ae,h as P,r as oe}from"./index-zLUezw_f.js";import{q as ne}from"./queryUrl-BTYYWpY7.js";import"./@vant-NmgEisJw.js";import"./@vue-office-GFDCm3nC.js";import"./vue-demi-BEcyFcst.js";import"./vue-RHKPHaPZ.js";import"./pinia-B_HOjTBS.js";import"./vue-router-Bw4qQE88.js";import"./@vueuse-QQdVrKV8.js";import"./xe-utils-DXe260hc.js";import"./axios-B4uVmeYG.js";import"./@x-ui-vue3-CwLx_scX.js";import"./pinia-plugin-persist-J3Q2VqHx.js";import"./vue3-menus-CnNWMJEM.js";import"./vue3-photo-preview-CkWuweRQ.js";import"./vxe-table-QgdefRjh.js";import"./dom-zindex-GlLoxNk1.js";const ie=g=>(H("data-v-ad6c9614"),g=g(),J(),g),re={class:"flex h-10 bar items-center y-Center px-1"},le={class:"min-w-4 px-1 h-4 ml-2 text-sm shadowC flex items-center justify-center text-white rounded-full bg-[#ffab30]"},ce={class:"mx-2"},de={class:"flex-1 justify-end pr-1 flex"},ue={class:"px-4 text-[14px] pb-[5px]"},pe={class:"font-bold min-h-8 text-[16px] yCenter justify-between"},me={class:"text-[#ffab30]"},_e={class:"min-h-6 yCenter"},ve={class:"inline-flex justify-between"},he=ie(()=>e("div",{class:"pr-2 leading-6"},"当前阶段:",-1)),fe={class:"leading-6"},ge={class:"min-h-6 yCenter"},xe={class:"min-h-6 yCenter"},be={class:"min-min-h-6 yCenter"},Ce={class:"min-h-6 yCenter"},ye={class:"min-h-6 yCenter"},Ie={__name:"card",props:["item"],setup(g){const s=g,m=te(),l=se();function i(o){const _=l[o.taskId]||l[o.stageId]||"-",u=l[o.stateId]||"-";return`${_} - ${u}`}return(o,_)=>{const u=z,k=O,w=E("skeleton-item"),C=E("skeleton");return L((d(),$(k,{inset:"",class:"!mb-2 shadowC van-haptics-feedback !rounded-xl"},{default:h(()=>[L((d(),b("div",null,[e("div",re,[e("div",le,a(s.item.index),1),e("div",ce,a(s.item.orderBase.orderId),1),e("div",de,[f(ee,{class:"!h-[18.7px]",onClick:_[0]||(_[0]=Q(x=>o.$copyText(s.item.orderBase.orderId),["stop"]))},{default:h(()=>[A("复制")]),_:1})])]),e("article",ue,[e("div",pe,[e("div",null,a(t(p.get)(s.item,"customer.name")||t(p.get)(s.item,"customerOrg.orgName")),1),e("div",me,[A("详情 "),f(u,{name:"arrow"})])]),e("div",_e,"进件编号: "+a(t(p.get)(s.item,"leaseReview.contractNumber","-")),1),e("div",ve,[he,e("div",fe,[(d(!0),b(S,null,V(s.item.currentOrderState,x=>(d(),b("div",{key:x,class:Y(`text-${o.$statusColor(t(l)[x.stateId])}`)},a(i(x)),3))),128))])]),e("div",ge,"所属组织: "+a(t(p.get)(s.item,"company.name","")),1),e("div",xe,"销售人员: "+a(t(p.get)(s.item,"orderBase.salesman","-")),1),e("div",be,"详细地址: "+a(t(p.get)(s.item,"orderBase.installationAddress","-")),1),e("div",Ce,"资方名称: "+a(o.$investorIdDic[t(p.get)(s.item,"orderBase.investorId","-")]),1),e("div",ye,"订单创建时间: "+a(t(p.get)(s.item,"orderBase.createTime","-")),1)])])),[[w]])]),_:1})),[[C,t(m).overlayShow]])}}},Se=X(Ie,[["__scopeId","data-v-ad6c9614"]]),ke={class:"yCenter"},we={class:"xCenter"},Be={class:"xCenter"},Te={class:"xCenter pt-2 text-[14px]"},Ne={__name:"designChange",setup(g){const s=v("");ae();const m=v(""),l=v([{taskId:"TASK_CSPSXX_UPDATE",stateName:"设计变更",count:0},{taskId:"TASK_CSPSXX",stateName:"一键变更",count:0}]),i=v({pageNum:1,pageSize:10,total:0}),o=v(!1),_=v(!1),u=v([]);function k(){}async function w(){i.value.pageNum=1,i.value.pageSize=10,u.value=[],C();const{data:c}=await P.get("design/record-count");l.value[1].count=c[0].count,l.value[0].count=c[1].count}const C=Z.debounce(x,300);async function x(){const c={...l.value[m.value],queryTag:s.value,stageId:"DESIGN"};let r="";m.value?(r="/order/search-exclude-states",c.stateId="APPROVAL_PASS_BTO"):(c.excludeSpecialStateIds=["LOCK","TERMINATE"],r="/order/search");const{data:y}=await P.post(ne(r,i.value),c),I=y.total;i.value.total=I;const B=y.list.map((T,N)=>({...T,index:u.value.length+N+1}));u.value.push(...B),o.value=!1,_.value=i.value.pageNum*i.value.pageSize>I,i.value.pageNum++}function j(c){oe.push({path:"/itemDetail",query:{orderId:c.orderBase.orderId}})}return W(()=>{}),(c,r)=>{const y=G,I=U,B=K,T=R,N=F,q=M;return d(),b(S,null,[f(I,{modelValue:t(s),"onUpdate:modelValue":r[0]||(r[0]=n=>D(s)?s.value=n:null),shape:"round",background:"#fff",placeholder:"系统编号、进件编号、组织全称、姓名、手机号","show-action":"",class:"van-hairline--bottom"},{action:h(()=>[e("div",ke,[f(y,{onClick:k,class:"!w-auto !h-[30px] shadow !px-[15px] !rounded-full !border-none !bg-[#ffab30] !text-white"},{default:h(()=>[A(" 搜索 ")]),_:1})])]),_:1},8,["modelValue"]),f(T,{active:t(m),"onUpdate:active":r[1]||(r[1]=n=>D(m)?m.value=n:null),"line-width":"0",ellipsis:!1,"title-active-color":"#ffab30",onChange:w},{default:h(()=>[(d(!0),b(S,null,V(t(l),n=>(d(),$(B,null,{title:h(()=>[e("div",we,a(n.count),1),e("div",Be,a(n.stateName),1)]),_:2},1024))),256))]),_:1},8,["active"]),e("div",Te,"有效订单数量: "+a(t(i).total),1),f(N,{loading:t(o),"onUpdate:loading":r[2]||(r[2]=n=>D(o)?o.value=n:null),finished:t(_),"finished-text":"没有更多了",onLoad:t(C),class:"!pt-2"},{default:h(()=>[(d(!0),b(S,null,V(t(u),n=>(d(),$(Se,{key:n.orderBase.orderId,onClick:De=>j(n),item:n},null,8,["onClick","item"]))),128))]),_:1},8,["loading","finished","onLoad"]),f(q,{class:"!bg-[#fed38c]"})],64)}}},We=X(Ne,[["__scopeId","data-v-ce37bad5"]]);export{We as default};
