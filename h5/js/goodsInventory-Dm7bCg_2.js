import{a as U,o as V,j as z}from"./vant-DL9g20lT.js";import{_ as J}from"./cell-CHAqLe0U.js";import{m as M,_ as P}from"./makeForm-C_uyyvx9.js";import{m as S,b as Z}from"./backfill-hh-glB-L.js";import{b as q,m as R}from"./makeSelect-BzGYyrzS.js";import{c as g,h as f,g as k,s as v}from"./index-NPFU1_kq.js";import"./lodash-C-AG1eJN.js";import{q as b}from"./queryUrl-ggRt1bhs.js";import{f as T,r as A,e as B,$ as d,Z as c,_ as x,N as e,u as h,a8 as r,F as I,a2 as N,a4 as Q,V as Y,a3 as $,a0 as D,i as j,a5 as E}from"./@vue-BhOIXUCP.js";import"./@vant-D2Uub16A.js";import"./class-rRG2y2aF.js";import"./pinia-CQ-jtR3-.js";import"./vue-demi-Dq6ymT-8.js";import"./vue-router-XNYRUkAR.js";import"./@vueuse-BaMGbt4d.js";import"./axios-B6xwUs71.js";import"./@x-ui-vue3-bC99Tnvx.js";import"./pinia-plugin-persist-J3Q2VqHx.js";import"./vue3-menus-VHbn-zkx.js";import"./vue3-photo-preview-Dedu722r.js";import"./vxe-table-BBegQXiE.js";import"./xe-utils-BM3aD2L3.js";import"./dayjs-Bof1u0Bp.js";import"./dom-zindex-GlLoxNk1.js";const L=[S("仓库"),{...q(),...R("stoId",[],"dynamic"),label:"仓库",name:"stoId",required:!0,async backfill(){const m=g(),a={};a.stoType=m.deliveryType=="FIRST"?"ZY":"JMS";const{data:s}=await f.get(b("sto/room-sto-type",a)),n=s.map(p=>({...p,text:p.stoName,value:p.stoId}));this.makeSelect("",n)}},{label:"仓库类型",readonly:!0,name:"type",formType:"input",value:"",realValue:"",backfill(){const m={ZY:"一级仓库(直营)",JMS:"二级仓库(供应商)"},a=g();this.realValue=a.deliveryType=="FIRST"?"ZY":"JMS",this.value=m[this.realValue]}},{formType:"input",inputAlign:"center",inlineForm:[{slot:"input",formType:"button",text:"查询",type:"primary",class:" !py-1 !bg-[#ffab30] text-white !border-0 w-[50%]",round:!0,size:"small",click(){if(!k("stoId","realValue").length){U("仓库必选");return}v("tableTitle","hidden",!1),v("tabs",a=>{a.hidden=!1,a.search()})}}]}],X=[{...S("设备"),hidden:!0,name:"tableTitle",onMounted(){T(()=>{this.hidden=!0})}},{formType:"",name:"tabs",hidden:!0,onMounted(){T(()=>{this.hidden=!0})},customSlot:"tabs",page:{pageSize:1,pageNum:10,total:""},params:{stoId:"",deviceType:"ZUJIAN"},tabs:[{title:"组件",name:"ZUJIAN",value:"",data:[],header:[]},{title:"逆变器",name:"NBQ",value:"",data:[],header:[]},{title:"采集器",name:"CJQ",value:"",data:[],header:[]},{title:"配电箱",name:"PDX",value:"",data:[],header:[]}],async changeTab(m){this.params.stoId=k("stoId","realValue")||this.params.stoId,this.params.deviceType=m||this.params.deviceType;const a={...this.params,...this.page};{const{data:s}=await f.get(b("sto/sto-device/show-device",a));this.tabs.find(n=>n.name==this.params.deviceType).data=s.records,this.page.total=s.totalRow}{const{data:s}=await f.get(b("sto/sto-device/show-count",a));this.tabs.find(n=>n.name==this.params.deviceType).header=s}},async search(){this.page.pageSize=1,this.page.pageNum=10,this.changeTab()}}],G={class:"xCenter"},ye={__name:"goodsInventory",setup(m){const a=M({form:L,tableForm:X}),s=A("ZUJIAN");return g(),B(()=>{Z(a,{}),v("tabs",n=>n.changeTab("ZUJIAN"))}),(n,p)=>{const _=P,u=d("vxe-column"),i=J,y=d("vxe-table"),w=d("vxe-pager"),C=V,F=z;return c(),x(I,null,[e(_,{form:h(a).form,class:"pt-3","group-class":"shadowC"},null,8,["form"]),e(_,{form:h(a).tableForm,class:"pt-3","group-class":"shadowC"},{tabs:r(({slot:o})=>[o.hidden?E("",!0):(c(),N(F,{key:0,class:"flex-1 flex flex-col pb-3",active:h(s),"onUpdate:active":p[0]||(p[0]=l=>j(s)?s.value=l:null),background:"#fff","line-width":"80px",color:"#ffab30",onChange:l=>o.changeTab(l)},{default:r(()=>[(c(!0),x(I,null,Q(o.tabs,l=>(c(),N(C,{title:l.title,name:l.name,key:l.name},{default:r(()=>[e(y,{data:l.header,align:"center","header-align":"center","max-height":"400",headerRowClassName:"bg-[#ffab30] text-white"},{default:r(()=>[e(u,{field:"amount",title:"物料名称",width:"25%"},{default:r(({row:t})=>[Y($(l.title),1)]),_:2},1024),e(u,{field:"value",title:"详细信息"},{default:r(({row:t})=>[e(i,{title:"数量",value:t.amount+" 块"},null,8,["value"]),e(i,{title:"规格",value:t.specificationsModel},null,8,["value"]),e(i,{title:"厂家",value:t.manufacturer},null,8,["value"])]),_:1})]),_:2},1032,["data"]),e(y,{data:l.data,align:"center","header-align":"center","max-height":"400",headerRowClassName:"bg-[#ffab30] text-white",class:"mt-5"},{default:r(()=>[e(u,{type:"seq",width:"50",title:"序号"}),e(u,{field:"value",title:"详细信息"},{default:r(({row:t})=>[e(i,{title:"设备编号",value:t.deviceId},null,8,["value"]),e(i,{title:"生产厂家",value:t.manufacturer},null,8,["value"]),e(i,{title:"供应商",value:t.supplier},null,8,["value"]),e(i,{title:"规格型号",value:t.specificationsModel},null,8,["value"]),e(i,{title:"错误信息",value:t.valid,titleClass:"!text-[red] !w-auto !flex-none",valueClass:"text-red"},null,8,["value"])]),_:1})]),_:2},1032,["data"]),D("div",G,[e(w,{layouts:["PrevPage","Number","NextPage","FullJump","Total"],"current-page":o.page.pageSize,"onUpdate:currentPage":t=>o.page.pageSize=t,"page-size":o.page.pageNum,"onUpdate:pageSize":t=>o.page.pageNum=t,total:o.page.total,onPageChange:()=>o.changeTab()},null,8,["current-page","onUpdate:currentPage","page-size","onUpdate:pageSize","total","onPageChange"])])]),_:2},1032,["title","name"]))),128))]),_:2},1032,["active","onChange"]))]),_:1},8,["form"])],64)}}};export{ye as default};
