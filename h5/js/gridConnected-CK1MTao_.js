import{_ as T}from"./vBtn-h-mmgtbW.js";import{m as F,_ as C}from"./makeForm-C_uyyvx9.js";import{m as p,a as S,b as q}from"./backfill-hh-glB-L.js";import{m as f}from"./makeDate-DLj2cL6Z.js";import{m as c,a as u}from"./makeUpload-FhoYjxox.js";import{y as k,z as g,h as s,c as A,e as O,n as D}from"./index-NPFU1_kq.js";import{l as t}from"./lodash-C-AG1eJN.js";import{b as y,m as b}from"./makeSelect-BzGYyrzS.js";import{r as I}from"./runTime-DAjLGjV1.js";import{q as h}from"./queryUrl-ggRt1bhs.js";import{e as B,Z as L,_ as N,N as i,u as m,F as U}from"./@vue-BhOIXUCP.js";import"./vant-DL9g20lT.js";import"./@vant-D2Uub16A.js";import"./class-rRG2y2aF.js";import"./dayjs-Bof1u0Bp.js";import"./axios-B6xwUs71.js";import"./pinia-CQ-jtR3-.js";import"./vue-demi-Dq6ymT-8.js";import"./vue-router-XNYRUkAR.js";import"./@vueuse-BaMGbt4d.js";import"./@x-ui-vue3-bC99Tnvx.js";import"./pinia-plugin-persist-J3Q2VqHx.js";import"./vue3-menus-VHbn-zkx.js";import"./vue3-photo-preview-Dedu722r.js";import"./vxe-table-BBegQXiE.js";import"./xe-utils-BM3aD2L3.js";import"./dom-zindex-GlLoxNk1.js";const x=[p("并网信息"),{...f({name:"startTime"}),label:"供电验收时间",required:!0},{...f({name:"checkAcceptTime"}),label:"并网合闸时间",required:!0},{formType:"input",label:"电厂交易编号",value:"",required:!0,name:"generatorNumber",placeholder:"请认真核对后输入"},{formType:"input",label:"并网备注(选填)",value:"",name:"annotation",placeholder:"请输入"}],z=[p("并网资料"),{label:"补充/整改施工影像件(选填)",name:"zlwOtherFile",...c(999,100),backfill(e){t.bind(u,this)(e)},getParam(e){e[this.name]=e[this.name].map(a=>k(a))}}],M=[p("并网资料"),{label:"电站发电量监控截图(发电三天)",name:"monitor",required:!0,...c(999,100),backfill(e){t.bind(u,this)(e)},getParam(e){e.monitor=e.monitor.map(a=>g(a.url))}}],V=[p("发电影响复核"),{label:"全方位阴影遮挡情况水印照",name:"omnibearingShadowOcclusion",required:!0,...c(999,100),backfill(e){t.bind(u,this)(e)},getParam(e){e.omnibearingShadowOcclusion=e.omnibearingShadowOcclusion.map(a=>g(a.url))}},{label:"四周遮挡复核环绕视频",name:"allAroundReviewSurroundVideo",required:!0,...c(999,100),backfill(e){t.bind(u,this)(e)},getParam(e){e.allAroundReviewSurroundVideo=e.allAroundReviewSurroundVideo.map(a=>g(a.url))}}],W=[p("财产险"),{...f({name:"startDate"}),label:"保险开始日期",required:!0},{...f({name:"endDate"}),label:"保险结束日期",required:!0},{formType:"input",label:"保险公司",name:"insuranceCompany",placeholder:"请选择",...y(),...b("insuranceCompany",[],"dynamic"),async backfill(e){const{data:a}=await s.get("insurance/getInsuranceCompany"),o=a.map(r=>({text:r.insuranceCompany,value:r.insuranceCompany}));console.log(e[this.name],e),this.makeSelect(e[this.name],o)}},{formType:"input",label:"保险编号",requred:!0,name:"insuranceNumber",value:"",placeholder:"请输入"},{formType:"input",label:"保险类型",name:"insuranceType",readonly:!0,...y(),...b("insuranceType",[{value:1,text:"财产险"}]),value:1},{formType:"input",label:"投保金额",value:"",name:"insuredAmount",type:"digit",placeholder:"等于每W单价乘以总容量(W)",...S("元")},{formType:"input",label:"第一受益人",name:"beneficiary",value:"",placeholder:"请选择",...y(),...b("beneficiary",[],"dynamic"),async backfill(e){const{data:a}=await s.get("insurance/getBeneficiaryCompany"),o=a.map(r=>({text:r.beneficiary,value:r.beneficiary}));this.makeSelect(e[this.name],o)}},{...c(999,100),label:"电站保险单(PDF文档)",name:"insurancePolicyP",required:!0,backfill(e){t.bind(u,this)(e.insuranceList[0])},getParam(e){t.isArray(e.insuranceList)||(e.insuranceList=[{}]);const a=["startDate","endDate","insuranceCompany","insuranceNumber","insuranceType","insuredAmount","beneficiary","insurancePolicyP"],o=t.pick(e,[...a,"orderId"]);e.insurancePolicyP=e.insurancePolicyP.map(r=>k(r)),o.insurancePolicyP=JSON.stringify(e.insurancePolicyP),e.insuranceList=[o],delete e.insurancePolicyP}}],ye={__name:"gridConnected",setup(e){let a=F({gridConnectedMessageForm:x,zlwOtherFile:z,monitorForm:M,omnibearingShadowOcclusionForm:V,propertyInsuranceForm:W});const o=A();B(()=>{I(r)});async function r(){const n="/order/get-grid",{data:d}=await s.get(h(n,o));q(a,{...d,...d.insuranceList[0]})}async function w(){const n=D();return await s.post("order/put-grid",n)}async function _(n){n.taskId="TASK_BWXX",await s.post(h("approval/put-approval/bto/grid",n))}async function v(n){n.taskId="TASK_BWXX",await s.post("approval/do-approval/bto/grid",n)}return O({getData:r,saveData:w,submitData:_,approvalData:v}),(n,d)=>{const l=C,P=T;return L(),N(U,null,[i(l,{form:m(a).gridConnectedMessageForm,class:"pt-3","group-class":"shadowC"},null,8,["form"]),i(l,{form:m(a).zlwOtherFile,class:"pt-3","group-class":"shadowC"},null,8,["form"]),i(l,{form:m(a).monitorForm,class:"pt-3","group-class":"shadowC"},null,8,["form"]),i(l,{form:m(a).omnibearingShadowOcclusionForm,class:"pt-3","group-class":"shadowC"},null,8,["form"]),i(l,{form:m(a).propertyInsuranceForm,class:"pt-3","group-class":"shadowC"},null,8,["form"]),i(P)],64)}}};export{ye as default};
