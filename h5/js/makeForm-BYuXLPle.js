import{g as $,K as T,l as N,e as W,f as A,M as G,O as L,Q as O,B as j,U as z,V as K,u as X,R as q,y as Q,W as Y,X as H,I as J,Y as Z,C as ee,F as oe}from"./vant-xiv0EFx3.js";import{e as ne,o as I,b3 as se,aX as p,al as w,b1 as F,F as k,b2 as S,aj as h,ar as V,u as l,bA as f,N as b,ak as D,V as re,P as ae,bD as U,b4 as te,i as le,c as x,X as ce,Q as ie,G as ue,d as de,aS as pe}from"./@vue-BHA94vdH.js";import{L as fe,B as v,F as B,b as ge,u as he,M as me}from"./index-BCLLWcQc.js";import{l as s,a as ve}from"./lodash-C1iNKp1x.js";const E={input:$,switch:T,cell:N,popup:W,popover:A,cascader:G,calendar:L,pick:O,button:j,upload:z,numberKeyboard:K,radioGroup:X,radio:q,icon:Q,date:Y,text:H};function _e(e){let r=s.get(e,"labelClass","");return r+=" !min-w-[30%]",r=s.uniq(r.split(" ")).join(" "),s.set(e,"labelClass",r),s.has(e,"inputAlign")||(e.inputAlign="right"),e.formType=="input"&&be(e),E[e.formType]||e.formType}function be(e){s.isUndefined(e.type)&&(e.type="textarea"),s.merge(e,{autosize:!0,rows:"1"})}const Ce={__name:"recuDynComponent",props:{form:{},title:{},titleClass:{},fullPath:{}},setup(e){Date.now()+s.random(0,100);const r=location.port==2222?"/orderh5":"",a=e;function t(i){const u=[];return s.omit(i,["formType","inlineForm","realValue",...u])}function d(i){let u=!1;return s.isBoolean(i.hidden)&&(u=i.hidden),s.isFunction(i.hidden)&&(u=i.hidden()),le(i.hidden)&&(u=i.hidden),u}ne(()=>{}),I(()=>{});function c(i,u,...m){return s.isFunction(i[u])?i[u](...m):()=>{}}return(i,u)=>{const m=se("recuDynComponent",!0),g=J,C=Z;return p(!0),w(k,null,F([a.form].flat(),(n,_)=>(p(),w(k,{key:_},[S(i.$slots,n.customSlot),d(n)?D("",!0):(p(),h(te(l(E)[n.formType]),ae({key:0,modelValue:n.value,"onUpdate:modelValue":o=>n.value=o,show:n.show,"onUpdate:show":o=>n.show=o,ref_for:!0},t(n),{onClick:U((...o)=>c(n,"click",...o),["stop"]),onClose:(...o)=>c(n,"close",...o),onFinish:(...o)=>c(n,"finish",...o),onClickRightIcon:(...o)=>c(n,"clickRightIcon",...o),onClickLeftIcon:(...o)=>c(n,"clickLeftIcon",...o),onClickOverlay:U((...o)=>c(n,"clickOverlay",...o),["stop"]),onConfirm:(...o)=>c(n,"confirm",...o),onInput:(...o)=>c(n,"input",...o),onBlur:(...o)=>c(n,"blur",...o),onSelect:(...o)=>c(n,"select",...o),onClickPreview:(...o)=>c(n,"clickPreview",...o),onCancel:(...o)=>c(n,"cancel",...o),"onUpdate:modelValue":(...o)=>c(n,"updateValue",...o)}),V({"preview-cover":f(o=>[l(fe)(o)?(p(),h(g,{key:1,src:o.url||o.objectUrl,class:"w-[80px] h-[80px] bg-[#f7f8fa]",fit:"cover"},{error:f(()=>[re("加载失败")]),loading:f(()=>[b(C,{type:"spinner",size:"20"})]),_:2},1032,["src"])):(p(),w(k,{key:0},[l(v)(o).endsWith(".pdf")?(p(),h(g,{key:0,src:`.${l(r)}/icons/office/pdf.svg`,class:"w-[80px] h-[80px] !rounded-[8px] bg-[#f7f8fa]",fit:"contain"},null,8,["src"])):l(v)(o).endsWith(".docx")||l(v)(o).endsWith(".doc")?(p(),h(g,{key:1,src:`.${l(r)}/icons/office/word.svg`,class:"w-[80px] h-[80px] !rounded-[8px] bg-[#f7f8fa]",fit:"contain"},null,8,["src"])):l(v)(o).endsWith(".xlsx")||l(v)(o).endsWith(".xls")?(p(),h(g,{key:2,src:`.${l(r)}/icons/office/excel.svg`,class:"w-[80px] h-[80px] !rounded-[8px] bg-[#f7f8fa]",fit:"contain"},null,8,["src"])):D("",!0)],64))]),_:2},[F(l(ve.get)(n,"inlineForm",[]),o=>({name:o.slot,fn:f(()=>[b(m,{form:o},null,8,["form"])])}))]),1040,["modelValue","onUpdate:modelValue","show","onUpdate:show","onClick","onClose","onFinish","onClickRightIcon","onClickLeftIcon","onClickOverlay","onConfirm","onInput","onBlur","onSelect","onClickPreview","onCancel"]))],64))),128)}}},De={__name:"vantForm",props:{form:{},title:{},titleClass:{},groupClass:{},approvalName:{},readonly:{},disabled:{},showErrorMessage:{}},emits:["submit"],setup(e,{emit:r}){const a=e,t=B(),d=ge(),c=x(()=>s.isUndefined(a.readonly)?!d.btns.canEdit:a.readonly),i=x(()=>s.isUndefined(a.disabled)?!d.btns.canEdit:a.disabled),u=x(()=>s.isUndefined(a.showErrorMessage)?d.btns.canEdit:a.showErrorMessage),m=[a.form].flat().filter(n=>n?.customSlot).map(n=>n.customSlot);function g(n){return s.find(a.form,_=>_.customSlot==n)}function C(n){n&&t.submitDoms.push(n),a.approvalName&&(t.approvalDoms[a.approvalName]=n)}return I(()=>{t.submitDoms.length=0,t.approvalDoms={}}),(n,_)=>{const o=ee,R=oe,P=ce("skeleton");return ie((p(),h(R,{ref:C,readonly:l(c),disabled:l(i),"show-error-message":l(u)},{default:f(()=>[b(o,{inset:"",class:ue([a.groupClass,""])},{default:f(()=>[b(Ce,{form:a.form},V({_:2},[F(l(m),y=>({name:y,fn:f(()=>[S(n.$slots,y,{slot:g(y)})])}))]),1032,["form"])]),_:3},8,["class"])]),_:3},8,["readonly","disabled","show-error-message"])),[[P,l(d).overlayShow]])}}};function ye(e){return e.map(r=>({validator(a){const t=r(a);return this.message=t,!s.get(t,"length")},message:"",trigger:"onSubmit"}))}function we(e){if(s.isFunction(e)&&console.log(e()),e.required){const a=e.label;e.rules=[...s.get(e,"rules",[]),t=>t.length||`${a}必填`]}s.forIn(e,async(a,t)=>{t=="formType"&&_e(e),t=="inlineForm"&&M(e[t]),t=="rules"&&e.rules.length&&!e.rulesFlag&&(e.rulesFlag=!0,e.rules=[...ye(e[t])]),t=="onMounted"&&pe(async()=>{await e.onMounted(e)})}),s.isArray(e.menuRight)||(e.menuRight=[]),e.class=s.get(e,"class","");const r=s.get(e,"name","");return e.class+=` ${r}`,e}function M(e){for(let r=0;r<e.length;r++)s.isFunction(e[r])?e[r]=e[r]():e[r]=we(e[r]);return e}function Ue(e,r=!0){e=s.mapValues(e,t=>M(t).flat());const a=de(e);return r&&(me._=a),I(()=>{B().$reset();const d=he();d.approvalBackfill=()=>{},d.$reset()}),a}export{De as _,ye as c,Ue as m};
