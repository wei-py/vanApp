import{g as R,K as P,l as T,e as N,f as $,M as A,O as G,Q as L,B as O,U as j,V as z,u as K,R as X,y as q,W as Q,X as W,I as Y,Y as H,C as J,F as Z}from"./vant-xiv0EFx3.js";import{e as oo,o as k,b3 as eo,aX as f,al as F,b1 as w,F as I,b2 as S,aj as _,ar as U,u as p,bA as d,N as v,V as no,P as so,bD as D,b4 as ro,ak as ao,i as to,c as y,X as lo,Q as co,G as uo,d as io,aS as po}from"./@vue-BHA94vdH.js";import{L as fo,F as V,b as go,u as ho,M as mo}from"./index-Dd7uG9g0.js";import{l as s,a as _o}from"./lodash-C1iNKp1x.js";const x={input:R,switch:P,cell:T,popup:N,popover:$,cascader:A,calendar:G,pick:L,button:O,upload:j,numberKeyboard:z,radioGroup:K,radio:X,icon:q,date:Q,text:W};function vo(o){let a=s.get(o,"labelClass","");return a+=" !min-w-[30%]",a=s.uniq(a.split(" ")).join(" "),s.set(o,"labelClass",a),s.has(o,"inputAlign")||(o.inputAlign="right"),o.formType=="input"&&Co(o),x[o.formType]||o.formType}function Co(o){s.isUndefined(o.type)&&(o.type="textarea"),s.merge(o,{autosize:!0,rows:"1"})}const bo={__name:"recuDynComponent",props:{form:{},title:{},titleClass:{},fullPath:{}},setup(o){Date.now()+s.random(0,100);const a=location.port==2222?"/orderh5":"",r=o;function t(c){const u=[];return s.omit(c,["formType","inlineForm","realValue",...u])}function i(c){let u=!1;return s.isBoolean(c.hidden)&&(u=c.hidden),s.isFunction(c.hidden)&&(u=c.hidden()),to(c.hidden)&&(u=c.hidden),u}oo(()=>{}),k(()=>{});function l(c,u,...g){return s.isFunction(c[u])?c[u](...g):()=>{}}return(c,u)=>{const g=eo("recuDynComponent",!0),h=Y,C=H;return f(!0),F(I,null,w([r.form].flat(),(n,m)=>(f(),F(I,{key:m},[S(c.$slots,n.customSlot),i(n)?ao("",!0):(f(),_(ro(p(x)[n.formType]),so({key:0,modelValue:n.value,"onUpdate:modelValue":e=>n.value=e,show:n.show,"onUpdate:show":e=>n.show=e,ref_for:!0},t(n),{onClick:D((...e)=>l(n,"click",...e),["stop"]),onClose:(...e)=>l(n,"close",...e),onFinish:(...e)=>l(n,"finish",...e),onClickRightIcon:(...e)=>l(n,"clickRightIcon",...e),onClickLeftIcon:(...e)=>l(n,"clickLeftIcon",...e),onClickOverlay:D((...e)=>l(n,"clickOverlay",...e),["stop"]),onConfirm:(...e)=>l(n,"confirm",...e),onInput:(...e)=>l(n,"input",...e),onBlur:(...e)=>l(n,"blur",...e),onSelect:(...e)=>l(n,"select",...e),onClickPreview:(...e)=>l(n,"clickPreview",...e),onCancel:(...e)=>l(n,"cancel",...e),"onUpdate:modelValue":(...e)=>l(n,"updateValue",...e)}),U({"preview-cover":d(e=>[p(fo)(e)?(f(),_(h,{key:1,src:e.url||e.objectUrl,class:"w-[80px] h-[80px] bg-[#f7f8fa]",fit:"cover"},{error:d(()=>[no("加载失败")]),loading:d(()=>[v(C,{type:"spinner",size:"20"})]),_:2},1032,["src"])):(f(),_(h,{key:0,src:`.${p(a)}/background/pdf.png`,class:"w-[80px] h-[80px] !rounded-[8px] bg-[#f7f8fa]",fit:"contain"},null,8,["src"]))]),_:2},[w(p(_o.get)(n,"inlineForm",[]),e=>({name:e.slot,fn:d(()=>[v(g,{form:e},null,8,["form"])])}))]),1040,["modelValue","onUpdate:modelValue","show","onUpdate:show","onClick","onClose","onFinish","onClickRightIcon","onClickLeftIcon","onClickOverlay","onConfirm","onInput","onBlur","onSelect","onClickPreview","onCancel"]))],64))),128)}}},So={__name:"vantForm",props:{form:{},title:{},titleClass:{},groupClass:{},approvalName:{},readonly:{},disabled:{},showErrorMessage:{}},emits:["submit"],setup(o,{emit:a}){const r=o,t=V(),i=go(),l=y(()=>s.isUndefined(r.readonly)?!i.btns.canEdit:r.readonly),c=y(()=>s.isUndefined(r.disabled)?!i.btns.canEdit:r.disabled),u=y(()=>s.isUndefined(r.showErrorMessage)?i.btns.canEdit:r.showErrorMessage),g=[r.form].flat().filter(n=>n?.customSlot).map(n=>n.customSlot);function h(n){return s.find(r.form,m=>m.customSlot==n)}function C(n){n&&t.submitDoms.push(n),r.approvalName&&(t.approvalDoms[r.approvalName]=n)}return k(()=>{t.submitDoms.length=0,t.approvalDoms={}}),(n,m)=>{const e=J,E=Z,M=lo("skeleton");return co((f(),_(E,{ref:C,readonly:p(l),disabled:p(c),"show-error-message":p(u)},{default:d(()=>[v(e,{inset:"",class:uo([r.groupClass,""])},{default:d(()=>[v(bo,{form:r.form},U({_:2},[w(p(g),b=>({name:b,fn:d(()=>[S(n.$slots,b,{slot:h(b)})])}))]),1032,["form"])]),_:3},8,["class"])]),_:3},8,["readonly","disabled","show-error-message"])),[[M,p(i).overlayShow]])}}};function yo(o){return o.map(a=>({validator(r){const t=a(r);return this.message=t,!s.get(t,"length")},message:"",trigger:"onSubmit"}))}function wo(o){if(s.isFunction(o)&&console.log(o()),o.required){const r=o.label;o.rules=[...s.get(o,"rules",[]),t=>t.length||`${r}必填`]}s.forIn(o,async(r,t)=>{t=="formType"&&vo(o),t=="inlineForm"&&B(o[t]),t=="rules"&&o.rules.length&&!o.rulesFlag&&(o.rulesFlag=!0,o.rules=[...yo(o[t])]),t=="onMounted"&&po(async()=>{await o.onMounted(o)})}),s.isArray(o.menuRight)||(o.menuRight=[]),o.class=s.get(o,"class","");const a=s.get(o,"name","");return o.class+=` ${a}`,o}function B(o){for(let a=0;a<o.length;a++)s.isFunction(o[a])?o[a]=o[a]():o[a]=wo(o[a]);return o}function Uo(o,a=!0){o=s.mapValues(o,t=>B(t).flat());const r=io(o);return a&&(mo._=r),k(()=>{V().$reset();const i=ho();i.approvalBackfill=()=>{},i.$reset()}),r}export{So as _,yo as c,Uo as m};
