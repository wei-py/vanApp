import{g as M,K as P,l as T,e as N,f as $,M as G,O as A,Q as L,B as O,U as z,V as K,u as j,R as q,y as Q,W as X,X as H,I as W,Y,C as Z,F as J}from"./vant-DL9g20lT.js";import{e as oo,o as w,$ as eo,Z as d,_ as k,a4 as y,F,a6 as D,a2 as h,ae as S,u as p,a8 as f,N as _,V as no,P as so,a1 as I,ab as ao,a5 as ro,i as to,c as b,X as lo,Q as co,G as uo,d as io,af as po}from"./@vue-BhOIXUCP.js";import{G as fo,A as U,b as mo,u as go,H as ho}from"./index-NPFU1_kq.js";import{l as r,a as _o}from"./lodash-C-AG1eJN.js";const x={input:M,switch:P,cell:T,popup:N,popover:$,cascader:G,calendar:A,pick:L,button:O,upload:z,numberKeyboard:K,radioGroup:j,radio:q,icon:Q,date:X,text:H};function vo(o){let l=r.get(o,"labelClass","");return l+=" !min-w-[30%]",l=r.uniq(l.split(" ")).join(" "),r.set(o,"labelClass",l),r.has(o,"inputAlign")||(o.inputAlign="right"),o.formType=="input"&&Co(o),x[o.formType]||o.formType}function Co(o){r.isUndefined(o.type)&&(o.type="textarea"),r.merge(o,{autosize:!0,rows:"1"})}const bo={__name:"recuDynComponent",props:{form:{},title:{},titleClass:{},fullPath:{}},setup(o){Date.now()+r.random(0,100);const l=o;function s(c){const i=[];return r.omit(c,["formType","inlineForm","realValue",...i])}function t(c){let i=!1;return r.isBoolean(c.hidden)&&(i=c.hidden),r.isFunction(c.hidden)&&(i=c.hidden()),to(c.hidden)&&(i=c.hidden),i}oo(()=>{}),w(()=>{});function a(c,i,...m){return r.isFunction(c[i])?c[i](...m):()=>{}}return(c,i)=>{const m=eo("recuDynComponent",!0),g=W,v=Y;return d(!0),k(F,null,y([l.form].flat(),(n,u)=>(d(),k(F,{key:u},[D(c.$slots,n.customSlot),t(n)?ro("",!0):(d(),h(ao(p(x)[n.formType]),so({key:0,modelValue:n.value,"onUpdate:modelValue":e=>n.value=e,show:n.show,"onUpdate:show":e=>n.show=e,ref_for:!0},s(n),{onClick:I((...e)=>a(n,"click",...e),["stop"]),onClose:(...e)=>a(n,"close",...e),onFinish:(...e)=>a(n,"finish",...e),onClickRightIcon:(...e)=>a(n,"clickRightIcon",...e),onClickLeftIcon:(...e)=>a(n,"clickLeftIcon",...e),onClickOverlay:I((...e)=>a(n,"clickOverlay",...e),["stop"]),onConfirm:(...e)=>a(n,"confirm",...e),onInput:(...e)=>a(n,"input",...e),onBlur:(...e)=>a(n,"blur",...e),onSelect:(...e)=>a(n,"select",...e),onClickPreview:(...e)=>a(n,"clickPreview",...e),onCancel:(...e)=>a(n,"cancel",...e),"onUpdate:modelValue":(...e)=>a(n,"updateValue",...e)}),S({"preview-cover":f(e=>[p(fo)(e)?(d(),h(g,{key:1,src:e.url||e.objectUrl,class:"w-[80px] h-[80px] bg-[#f7f8fa]",fit:"cover"},{error:f(()=>[no("加载失败")]),loading:f(()=>[_(v,{type:"spinner",size:"20"})]),_:2},1032,["src"])):(d(),h(g,{key:0,src:"./background/pdf.png",class:"w-[80px] h-[80px] !rounded-[8px] bg-[#f7f8fa]",fit:"contain"}))]),_:2},[y(p(_o.get)(n,"inlineForm",[]),e=>({name:e.slot,fn:f(()=>[_(m,{form:e},null,8,["form"])])}))]),1040,["modelValue","onUpdate:modelValue","show","onUpdate:show","onClick","onClose","onFinish","onClickRightIcon","onClickLeftIcon","onClickOverlay","onConfirm","onInput","onBlur","onSelect","onClickPreview","onCancel"]))],64))),128)}}},So={__name:"vantForm",props:{form:{},title:{},titleClass:{},groupClass:{},approvalName:{},readonly:{},disabled:{},showErrorMessage:{}},emits:["submit"],setup(o,{emit:l}){const s=o,t=U(),a=mo(),c=b(()=>r.isUndefined(s.readonly)?!a.btns.canEdit:s.readonly),i=b(()=>r.isUndefined(s.disabled)?!a.btns.canEdit:s.disabled),m=b(()=>r.isUndefined(s.showErrorMessage)?a.btns.canEdit:s.showErrorMessage),g=[s.form].flat().filter(u=>u?.customSlot).map(u=>u.customSlot);function v(u){return r.find(s.form,e=>e.customSlot==u)}function n(u){u&&t.submitDoms.push(u),s.approvalName&&(t.approvalDoms[s.approvalName]=u)}return w(()=>{t.submitDoms.length=0,t.approvalDoms={}}),(u,e)=>{const B=Z,E=J,R=lo("skeleton");return co((d(),h(E,{ref:n,readonly:p(c),disabled:p(i),"show-error-message":p(m)},{default:f(()=>[_(B,{inset:"",class:uo([s.groupClass,""])},{default:f(()=>[_(bo,{form:s.form},S({_:2},[y(p(g),C=>({name:C,fn:f(()=>[D(u.$slots,C,{slot:v(C)})])}))]),1032,["form"])]),_:3},8,["class"])]),_:3},8,["readonly","disabled","show-error-message"])),[[R,p(a).overlayShow]])}}};function yo(o){return o.map(l=>({validator(s){const t=l(s);return this.message=t,!r.get(t,"length")},message:"",trigger:"onSubmit"}))}function wo(o){if(o.required){const s=o.label;o.rules=[...r.get(o,"rules",[]),t=>t.length||`${s}必填`]}r.forIn(o,async(s,t)=>{t=="formType"&&vo(o),t=="inlineForm"&&V(o[t]),t=="rules"&&o.rules.length&&!o.rulesFlag&&(o.rulesFlag=!0,o.rules=[...yo(o[t])]),t=="onMounted"&&po(async()=>{await o.onMounted(o)})}),r.isArray(o.menuRight)||(o.menuRight=[]),o.class=r.get(o,"class","");const l=r.get(o,"name","");o.class+=` ${l}`}function V(o){for(let l=0;l<o.length;l++)wo(o[l])}function Uo(o,l=!0){r.forIn(o,t=>{V(t)});const s=io(o);return l&&(ho._=s),w(()=>{U().$reset();const a=go();a.approvalBackfill=()=>{},a.$reset()}),s}export{So as _,yo as c,Uo as m};
