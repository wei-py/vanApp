import{h as T,W as N,o as W,f as G,g as L,X as A,Y as j,Z as z,B as O,U as X,d as q,y as K,R as Q,t as Y,_ as Z,$ as H,I as J,L as ee,i as oe,F as ne}from"./vant-Ckwj66YG.js";import{e as se,o as I,b3 as re,aX as p,al as k,b1 as D,F as x,b2 as E,aj as m,ar as V,u as l,bA as b,N as C,ak as _,V as ae,P as te,bD as R,b4 as le,i as ce,c as F,X as ie,Q as ue,G as fe,d as de,f as pe,aS as he}from"./@vue-ts87NNlE.js";import{L as ge,D as g,G as $,b as me,u as be,M as ve}from"./index-DwbTWwPI.js";import{l as a,a as _e}from"./lodash-DhpMPSDc.js";const B={input:T,switch:N,cell:W,popup:G,popover:L,cascader:A,calendar:j,pick:z,button:O,upload:X,numberKeyboard:q,radioGroup:K,radio:Q,icon:Y,date:Z,text:H};function Ce(e){let n=a.get(e,"labelClass","");return n+=" !min-w-[30%]",n=a.uniq(n.split(" ")).join(" "),a.set(e,"labelClass",n),a.has(e,"inputAlign")||(e.inputAlign="right"),e.formType=="input"&&ye(e),B[e.formType]||e.formType}function ye(e){a.isUndefined(e.type)&&(e.type="textarea"),e.type=="digit"&&!a.isFunction(e.backfill)&&(e.backfill=function(n){console.log(this,n),this.value=n[this.name]}),a.merge(e,{autosize:!0,rows:"1"})}const we={__name:"recuDynComponent",props:{form:{},title:{},titleClass:{},fullPath:{}},setup(e){Date.now()+a.random(0,100);const n=location.port==2222?"/orderh5":"",r=e;function t(c){const u=[];return a.omit(c,["formType","inlineForm","realValue","ref",...u])}function d(c){let u=!1;return a.isBoolean(c.hidden)&&(u=c.hidden),a.isFunction(c.hidden)&&(u=c.hidden()),ce(c.hidden)&&(u=c.hidden),u}function U(c,u){}se(()=>{}),I(()=>{});function i(c,u,...v){return a.isFunction(c[u])?c[u](...v,c):()=>{}}return(c,u)=>{const v=re("recuDynComponent",!0),h=J,f=ee;return p(!0),k(x,null,D([r.form].flat(),(s,y)=>(p(),k(x,{key:y},[E(c.$slots,s.customSlot),d(s)?_("",!0):(p(),m(le(l(B)[s.formType]),te({key:0,ref_for:!0,ref:o=>void 0,modelValue:s.value,"onUpdate:modelValue":o=>s.value=o,show:s.show,"onUpdate:show":o=>s.show=o},t(s),{beforeRead:(...o)=>i(s,"beforeRead",...o),onClick:R((...o)=>i(s,"click",...o),["stop"]),onClose:(...o)=>i(s,"close",...o),onFinish:(...o)=>i(s,"finish",...o),onClickRightIcon:(...o)=>i(s,"clickRightIcon",...o),onClickLeftIcon:(...o)=>i(s,"clickLeftIcon",...o),onClickOverlay:R((...o)=>i(s,"clickOverlay",...o),["stop"]),onConfirm:(...o)=>i(s,"confirm",...o),onInput:(...o)=>i(s,"input",...o),onBlur:(...o)=>i(s,"blur",...o),onSelect:(...o)=>i(s,"select",...o),onClickPreview:(...o)=>i(s,"clickPreview",...o),onCancel:(...o)=>i(s,"cancel",...o),"onUpdate:modelValue":(...o)=>i(s,"updateValue",...o)}),V({"preview-cover":b(o=>[l(ge)(o)?(p(),m(h,{key:1,src:o.url||o.objectUrl,class:"w-[80px] h-[80px] bg-[#f7f8fa]",fit:"cover"},{error:b(()=>[ae("加载失败")]),loading:b(()=>[C(f,{type:"spinner",size:"20"})]),_:2},1032,["src"])):(p(),k(x,{key:0},[l(g)(o).endsWith(".pdf")?(p(),m(h,{key:0,src:`.${l(n)}/icons/office/pdf.svg`,class:"w-[80px] h-[80px] !rounded-[8px] bg-[#f7f8fa]",fit:"contain"},null,8,["src"])):_("",!0),l(g)(o).endsWith(".ppt")||l(g)(o).endsWith(".pptx")?(p(),m(h,{key:1,src:`.${l(n)}/icons/office/ppt.svg`,class:"w-[80px] h-[80px] !rounded-[8px] bg-[#f7f8fa]",fit:"contain"},null,8,["src"])):_("",!0),l(g)(o).endsWith(".docx")||l(g)(o).endsWith(".doc")?(p(),m(h,{key:2,src:`.${l(n)}/icons/office/word.svg`,class:"w-[80px] h-[80px] !rounded-[8px] bg-[#f7f8fa]",fit:"contain"},null,8,["src"])):_("",!0),l(g)(o).endsWith(".xlsx")||l(g)(o).endsWith(".xls")?(p(),m(h,{key:3,src:`.${l(n)}/icons/office/excel.svg`,class:"w-[80px] h-[80px] !rounded-[8px] bg-[#f7f8fa]",fit:"contain"},null,8,["src"])):_("",!0)],64))]),_:2},[D(l(_e.get)(s,"inlineForm",[]),o=>({name:o.slot,fn:b(()=>[C(v,{form:o},null,8,["form"])])}))]),1040,["modelValue","onUpdate:modelValue","show","onUpdate:show","beforeRead","onClick","onClose","onFinish","onClickRightIcon","onClickLeftIcon","onClickOverlay","onConfirm","onInput","onBlur","onSelect","onClickPreview","onCancel"]))],64))),128)}}},Ue={__name:"vantForm",props:{form:{},title:{},titleClass:{},groupClass:{},approvalName:{},readonly:{},disabled:{},showErrorMessage:{}},emits:["submit"],setup(e,{emit:n}){const r=e,t=$(),d=me(),U=F(()=>a.isUndefined(r.readonly)?!d.btns.canEdit:r.readonly),i=F(()=>a.isUndefined(r.disabled)?!d.btns.canEdit:r.disabled),c=F(()=>a.isUndefined(r.showErrorMessage)?d.btns.canEdit:r.showErrorMessage),u=[r.form].flat().filter(f=>f?.customSlot).map(f=>f.customSlot);function v(f){return a.find(r.form,s=>s.customSlot==f)}function h(f){f&&t.submitDoms.push(f),r.approvalName&&(t.approvalDoms[r.approvalName]=f)}return I(()=>{t.submitDoms.length=0,t.approvalDoms={}}),(f,s)=>{const y=oe,o=ne,P=ie("skeleton");return ue((p(),m(o,{ref:h,readonly:l(U),disabled:l(i),"show-error-message":l(c)},{default:b(()=>[C(y,{inset:"",class:fe([r.groupClass,""])},{default:b(()=>[C(we,{form:r.form},V({_:2},[D(l(u),w=>({name:w,fn:b(()=>[E(f.$slots,w,{slot:v(w)})])}))]),1032,["form"])]),_:3},8,["class"])]),_:3},8,["readonly","disabled","show-error-message"])),[[P,l(d).overlayShow]])}}};function ke(e){return e.map(n=>({validator(r){const t=n(r);return this.message=t,!a.get(t,"length")},message:"",trigger:"onSubmit"}))}function S(e){if(e.required){const r=e.label;e.rules=[...a.get(e,"rules",[]),t=>t.length||`${r}必填`]}a.forIn(e,async(r,t)=>{t=="formType"&&Ce(e),t=="inlineForm"&&M(e[t]),t=="rules"&&e.rules.length&&!e.rulesFlag&&(e.rulesFlag=!0,e.rules=[...ke(e[t])]),t=="onMounted"&&he(async()=>{await e.onMounted(e)})}),a.isArray(e.menuRight)||(e.menuRight=[]),e.class=a.get(e,"class","");const n=a.get(e,"name","");return e.class+=` ${n}`,e}function M(e){for(let n=0;n<e.length;n++)if(a.isFunction(e[n])){const r=e[n];e[n]=e[n](),e[n].forEach(t=>{S(t)}),pe(()=>{e[n]=r})}else e[n]=S(e[n]);return e}function Re(e,n=!0){e=a.mapValues(e,t=>M(t).flat());const r=de(e);return n&&(ve._=r),I(()=>{$().$reset();const d=be();d.approvalBackfill=()=>{},d.$reset()}),r}export{Ue as _,ke as c,Re as m};
