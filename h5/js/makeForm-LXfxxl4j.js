import{h as T,V as N,o as W,f as L,g as A,W as G,X as j,Y as z,B as O,U as X,Z as q,y as K,R as Q,t as Y,_ as Z,$ as H,I as J,L as ee,i as oe,F as ne}from"./vant-PdAvEskO.js";import{e as se,o as D,b3 as re,aX as p,al as k,b1 as I,F as x,b2 as V,aj as m,ar as B,u as i,bA as h,N as _,ak as R,V as ae,P as te,bD as U,b4 as le,i as ce,c as F,X as ie,Q as ue,G as fe,d as de,aS as pe}from"./@vue-ts87NNlE.js";import{L as he,B as v,F as E,b as ge,u as me,M as be}from"./index-D0ldpvYI.js";import{l as a,a as ve}from"./lodash-D-SkTV7p.js";const $={input:T,switch:N,cell:W,popup:L,popover:A,cascader:G,calendar:j,pick:z,button:O,upload:X,numberKeyboard:q,radioGroup:K,radio:Q,icon:Y,date:Z,text:H};function _e(e){let s=a.get(e,"labelClass","");return s+=" !min-w-[30%]",s=a.uniq(s.split(" ")).join(" "),a.set(e,"labelClass",s),a.has(e,"inputAlign")||(e.inputAlign="right"),e.formType=="input"&&Ce(e),$[e.formType]||e.formType}function Ce(e){a.isUndefined(e.type)&&(e.type="textarea"),a.merge(e,{autosize:!0,rows:"1"})}const ye={__name:"recuDynComponent",props:{form:{},title:{},titleClass:{},fullPath:{}},setup(e){Date.now()+a.random(0,100);const s=location.port==2222?"/orderh5":"",r=e;function t(l){const u=[];return a.omit(l,["formType","inlineForm","realValue","ref",...u])}function d(l){let u=!1;return a.isBoolean(l.hidden)&&(u=l.hidden),a.isFunction(l.hidden)&&(u=l.hidden()),ce(l.hidden)&&(u=l.hidden),u}function C(l,u){l&&(u.ref=l)}se(()=>{}),D(()=>{});function c(l,u,...b){return a.isFunction(l[u])?l[u](...b,l):()=>{}}return(l,u)=>{const b=re("recuDynComponent",!0),g=J,f=ee;return p(!0),k(x,null,I([r.form].flat(),(n,y)=>(p(),k(x,{key:y},[V(l.$slots,n.customSlot),d(n)?R("",!0):(p(),m(le(i($)[n.formType]),te({key:0,ref_for:!0,ref:o=>C(o,n),modelValue:n.value,"onUpdate:modelValue":o=>n.value=o,show:n.show,"onUpdate:show":o=>n.show=o},t(n),{beforeRead:(...o)=>c(n,"beforeRead",...o),onClick:U((...o)=>c(n,"click",...o),["stop"]),onClose:(...o)=>c(n,"close",...o),onFinish:(...o)=>c(n,"finish",...o),onClickRightIcon:(...o)=>c(n,"clickRightIcon",...o),onClickLeftIcon:(...o)=>c(n,"clickLeftIcon",...o),onClickOverlay:U((...o)=>c(n,"clickOverlay",...o),["stop"]),onConfirm:(...o)=>c(n,"confirm",...o),onInput:(...o)=>c(n,"input",...o),onBlur:(...o)=>c(n,"blur",...o),onSelect:(...o)=>c(n,"select",...o),onClickPreview:(...o)=>c(n,"clickPreview",...o),onCancel:(...o)=>c(n,"cancel",...o),"onUpdate:modelValue":(...o)=>c(n,"updateValue",...o)}),B({"preview-cover":h(o=>[i(he)(o)?(p(),m(g,{key:1,src:o.url||o.objectUrl,class:"w-[80px] h-[80px] bg-[#f7f8fa]",fit:"cover"},{error:h(()=>[ae("加载失败")]),loading:h(()=>[_(f,{type:"spinner",size:"20"})]),_:2},1032,["src"])):(p(),k(x,{key:0},[i(v)(o).endsWith(".pdf")?(p(),m(g,{key:0,src:`.${i(s)}/icons/office/pdf.svg`,class:"w-[80px] h-[80px] !rounded-[8px] bg-[#f7f8fa]",fit:"contain"},null,8,["src"])):i(v)(o).endsWith(".docx")||i(v)(o).endsWith(".doc")?(p(),m(g,{key:1,src:`.${i(s)}/icons/office/word.svg`,class:"w-[80px] h-[80px] !rounded-[8px] bg-[#f7f8fa]",fit:"contain"},null,8,["src"])):i(v)(o).endsWith(".xlsx")||i(v)(o).endsWith(".xls")?(p(),m(g,{key:2,src:`.${i(s)}/icons/office/excel.svg`,class:"w-[80px] h-[80px] !rounded-[8px] bg-[#f7f8fa]",fit:"contain"},null,8,["src"])):R("",!0)],64))]),_:2},[I(i(ve.get)(n,"inlineForm",[]),o=>({name:o.slot,fn:h(()=>[_(b,{form:o},null,8,["form"])])}))]),1040,["modelValue","onUpdate:modelValue","show","onUpdate:show","beforeRead","onClick","onClose","onFinish","onClickRightIcon","onClickLeftIcon","onClickOverlay","onConfirm","onInput","onBlur","onSelect","onClickPreview","onCancel"]))],64))),128)}}},De={__name:"vantForm",props:{form:{},title:{},titleClass:{},groupClass:{},approvalName:{},readonly:{},disabled:{},showErrorMessage:{}},emits:["submit"],setup(e,{emit:s}){const r=e,t=E(),d=ge(),C=F(()=>a.isUndefined(r.readonly)?!d.btns.canEdit:r.readonly),c=F(()=>a.isUndefined(r.disabled)?!d.btns.canEdit:r.disabled),l=F(()=>a.isUndefined(r.showErrorMessage)?d.btns.canEdit:r.showErrorMessage),u=[r.form].flat().filter(f=>f?.customSlot).map(f=>f.customSlot);function b(f){return a.find(r.form,n=>n.customSlot==f)}function g(f){f&&t.submitDoms.push(f),r.approvalName&&(t.approvalDoms[r.approvalName]=f)}return D(()=>{t.submitDoms.length=0,t.approvalDoms={}}),(f,n)=>{const y=oe,o=ne,P=ie("skeleton");return ue((p(),m(o,{ref:g,readonly:i(C),disabled:i(c),"show-error-message":i(l)},{default:h(()=>[_(y,{inset:"",class:fe([r.groupClass,""])},{default:h(()=>[_(ye,{form:r.form},B({_:2},[I(i(u),w=>({name:w,fn:h(()=>[V(f.$slots,w,{slot:b(w)})])}))]),1032,["form"])]),_:3},8,["class"])]),_:3},8,["readonly","disabled","show-error-message"])),[[P,i(d).overlayShow]])}}};function we(e){return e.map(s=>({validator(r){const t=s(r);return this.message=t,!a.get(t,"length")},message:"",trigger:"onSubmit"}))}function S(e){if(e.required){const r=e.label;e.rules=[...a.get(e,"rules",[]),t=>t.length||`${r}必填`]}a.forIn(e,async(r,t)=>{t=="formType"&&_e(e),t=="inlineForm"&&M(e[t]),t=="rules"&&e.rules.length&&!e.rulesFlag&&(e.rulesFlag=!0,e.rules=[...we(e[t])]),t=="onMounted"&&pe(async()=>{await e.onMounted(e)})}),a.isArray(e.menuRight)||(e.menuRight=[]),e.class=a.get(e,"class","");const s=a.get(e,"name","");return e.class+=` ${s}`,e}function M(e){for(let s=0;s<e.length;s++)a.isFunction(e[s])?(e[s]=e[s](),e[s].forEach(r=>{S(r)})):e[s]=S(e[s]);return e}function Re(e,s=!0){e=a.mapValues(e,t=>M(t).flat());const r=de(e);return s&&(be._=r),D(()=>{E().$reset();const d=me();d.approvalBackfill=()=>{},d.$reset()}),r}export{De as _,we as c,Re as m};
