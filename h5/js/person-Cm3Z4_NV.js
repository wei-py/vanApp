import{_ as F}from"./vButton-DxiVszE8.js";import{s as A,a as N,e as q,j as S,o as V}from"./vant-xiv0EFx3.js";import{m as U,_ as z}from"./makeForm-b9Rv_zTa.js";import{q as L}from"./@vant-BMzV8Unt.js";import{m as T,b as B}from"./backfill-Knvieq5z.js";import{p as M,f as u,s as n,j,h as g,a as G,k as O,o as R,l as D,g as s,_ as $,r as E}from"./index-BiU8ePZK.js";import"./lodash-C1iNKp1x.js";import{b as v,m as k}from"./makeSelect-VTItfMq-.js";import{q as H}from"./queryUrl-CUkA5NKU.js";import{c as t,e as J,aX as y,al as _,N as r,u as p,bA as m,am as P,F as W,b1 as X,aj as Y,V as K,a_ as Q,aY as Z}from"./@vue-BHA94vdH.js";import"./class-rRG2y2aF.js";import"./pinia-BOLtM30a.js";import"./vue-demi-Dq6ymT-8.js";import"./vue-router-BQWAt7JZ.js";import"./@vueuse-BYPNFz0v.js";import"./xe-utils-D22uZPtC.js";import"./dayjs-19KvoO9f.js";import"./axios-B6xwUs71.js";import"./@x-ui-vue3-DYFNhZJM.js";import"./pinia-plugin-persist-J3Q2VqHx.js";import"./vue3-menus--RpDJ8QK.js";import"./vue3-photo-preview-Byv7Qnko.js";import"./vxe-table-CbQjGgi9.js";import"./dom-zindex-GlLoxNk1.js";function I(){return window.getDeviceInfo=e=>JSON.parse(e),M({func:"getInfo"})}const C={version:"2.4.4",h5:"2.4.33"},ee=[{...T(""),titleClass:"w-full  text-xl center ",class:"!h-[90px]",backfill(){const e=u();this.title=e.name}},{formType:"input",leftIcon:"lock",label:"更换密码",value:"",isLink:!0,name:"onChangePassword",readonly:!0,click(){n("onChangePasswordPop","show",!0)}},{...v(),...k("companyId",[],"dymaic"),leftIcon:"cluster-o",name:"companyId",label:"所属组织",async backfill(){const e=u(),o=j(),d={userId:e.userId},{data:x}=await g.get(H("/user-company/get-user-companies",d)),l=x.map(a=>({value:a.company.companyId,text:a.company.name}));this.makeSelect(o.companyId,l),this.inlineForm[0].inlineForm[0].confirm=async a=>{n(this.name,"value",a.selectedOptions[0].text),n(this.name,"realValue",a.selectedOptions[0].value),n(this.name,"inlineForm.0.show",!1);const h=G();if(resp.code==200){const f=await I(),b=O(),w=h.usernameList[0],i={...b,...f,...w,type:"password"};await g.post("/login",i)}}}},{formType:"input",name:"h5",label:"版本信息",readonly:!0,value:"",onMounted(){this.value=C.h5},inlineForm:[{slot:"button",formType:"button",size:"mini",className:"px-3 yCenter !bg-[#ffab30] text-white rounded-2xl",text:"刷新",click(){location.reload()}}]},{formType:"input",name:"coreInfo",label:"内核信息",readonly:!0,value:"",os:"",async onMounted(){const e=await I();this.show=e.version!=C.version,this.os=e.os,this.value=e.version},inlineForm:[{slot:"button",formType:"button",size:"mini",className:"px-3 yCenter !bg-[#ffab30] text-white rounded-2xl",text:"下载 App",click(){n("coreInfo",e=>{e.os=="android"?D("https://www.btosolarman.com/APP/boGuangAPP/prod/boGuang.prop.apk"):A("网页无法下载; ios版, 请到testFlight中更新")})}}]},{...v(),...k("env",[{text:"开发环境",value:"dev"},{text:"生产环境",value:"prod"}]),value:"",realValue:"prod",name:"env",label:"当前环境",isLink:!1,readonly:!0},{formType:"input",label:"隐私政策",value:"",isLink:!0,name:"private",readonly:!0,value:"点击查看",click(){R("https://www.btosolarman.com/APP/boGuangAPP/privacy.txt",this.label)}}],te=[{...T("修改密码"),name:"onChangePasswordPop",titleClass:"w-full center text-xl",show:!1},{customSlot:"tabs",tab:"",tabs:["原密码修改","验证码修改"],name:"tab"},{formType:"input",name:"phone",label:"手机号码",inputAlign:"left",value:"",required:!0,backfill(){const e=u();this.value=e.phone}},{formType:"input",name:"code",inputAlign:"left",label:"验证码",value:"",required:!0,show:!1,inlineForm:[{slot:"button",formType:"button",size:"mini",className:"px-3 yCenter !bg-[#ffab30] text-white rounded-2xl",text:"获取验证码",async click(){if(this.text.includes("后重新获取")){N(this.text);return}u().phone,n("code",o=>{o.count.start(),this.text=t(()=>o.count.current.seconds?o.count.current.seconds+"s 后重新获取":"获取验证码")})}}],backfill(){this.count=L({time:60*1e3,seconds:!0}),this.hidden=t(()=>!s("tab","tab"))}},{formType:"input",labelClass:"hidden",name:"checkCode",pass:!1,inputAlign:"center",inlineForm:[{slot:"input",formType:"button",size:"mini",className:"px-7  yCenter !bg-[#ffab30] text-white rounded-2xl",text:"校验验证码",async click(){s("code","value"),s("phone","value"),n("checkCode",e=>{console.log(e,333333),e.pass=!0})}}],backfill(){this.hidden=t(()=>!s("tab","tab"))}},{formType:"input",name:"password",label:"原密码",inputAlign:"left",type:"password",value:"",required:!0,show:!1,rightIcon:"closed-eye",clickRightIcon(){this.show=!this.show},backfill(){this.hidden=t(()=>s("tab","tab")&&!s("checkCode","pass")),this.type=t(()=>this.show?"input":"password"),this.rightIcon=t(()=>this.show?"eye-o":"closed-eye")}},{formType:"input",name:"newPassword",label:"新密码",inputAlign:"left",type:"password",value:"",required:!0,show:!1,rightIcon:"closed-eye",clickRightIcon(){this.show=!this.show},backfill(){this.hidden=t(()=>s("tab","tab")&&!s("checkCode","pass")),this.type=t(()=>this.show?"input":"password"),this.rightIcon=t(()=>this.show?"eye-o":"closed-eye")}},{formType:"input",name:"confirmPassword",label:"确认密码",inputAlign:"left",type:"password",value:"",required:!0,show:!1,rightIcon:"closed-eye",clickRightIcon(){this.show=!this.show},backfill(){this.hidden=t(()=>s("tab","tab")&&!s("checkCode","pass")),this.type=t(()=>this.show?"input":"password"),this.rightIcon=t(()=>this.show?"eye-o":"closed-eye")}},{formType:"input",name:"button",labelClass:"!w-1/2 xCenter",valueClass:"!w-1/2 xCenter",inputAlign:"center",inlineForm:[{slot:"label",formType:"button",size:"mini",className:"px-10 yCenter !bg-[#f3f3f3] text-[#232323] rounded-2xl",text:"取消",click(){n("onChangePasswordPop","show",!1)}},{slot:"input",formType:"button",size:"mini",className:"px-10 center !bg-[#ffab30] text-white rounded-2xl",text:"确认",async click(){s("tab","tab")}}]}],oe=e=>(Q("data-v-06fe1059"),e=e(),Z(),e),se={class:"flex-1 bg-[#fbf9f6]"},ae=oe(()=>P("div",{class:"xCenter pt-[10%] text-[20px] text-white bgImg h-[30vh]"},"个人中心",-1)),ne={class:"xCenter mt-8 mx-7"},ie={__name:"person",setup(e){const o=U({form:ee,modifyForm:te});J(()=>{B(o,{})});function d(){E.replace("/login")}return(x,l)=>{const a=z,h=V,f=S,b=q,w=F;return y(),_("div",se,[ae,r(a,{form:p(o).form,class:"pt-3 mx-3 mt-[-15vh]","group-class":"shadowC "},null,8,["form"]),r(b,{show:p(o).modifyForm[0].show,"onUpdate:show":l[0]||(l[0]=i=>p(o).modifyForm[0].show=i),class:"!w-[90%] !mt-[-20%]",round:"",position:"center"},{default:m(()=>[r(a,{form:p(o).modifyForm,"group-class":"shadowC"},{tabs:m(({slot:i})=>[r(f,{class:"flex-1 flex flex-col",active:i.tab,"onUpdate:active":c=>i.tab=c,background:"#f3f3f3","line-width":"80px",color:"#ffab30",swipeable:""},{default:m(()=>[(y(!0),_(W,null,X(i.tabs,c=>(y(),Y(h,{title:c,key:c},null,8,["title"]))),128))]),_:2},1032,["active","onUpdate:active"])]),_:1},8,["form"])]),_:1},8,["show"]),P("div",ne,[r(w,{class:"w-full",onClick:d},{default:m(()=>[K("退出登录")]),_:1})])])}}},qe=$(ie,[["__scopeId","data-v-06fe1059"]]);export{qe as default};
