import{_ as P}from"./vButton-BZ9jSBPU.js";import{s as A,a as N,f as S,m as q,r as V}from"./vant-Ckwj66YG.js";import{m as U,_ as z}from"./makeForm-CsZjxp4a.js";import{q as L}from"./@vant-NmgEisJw.js";import{m as I,b as B}from"./backfill-CdlEvImR.js";import{p as C,j as u,s as n,k as M,h as x,a as O,l as D,b as T,m as G,o as R,g as s,_ as j,r as J}from"./index-zLUezw_f.js";import"./lodash-DhpMPSDc.js";import{b as k,m as v}from"./makeSelect-B5t5onyK.js";import{q as $}from"./queryUrl-BTYYWpY7.js";import{c as o,e as E,aX as y,al as _,N as r,u as p,bA as m,am as F,F as H,b1 as W,aj as X,V as Y,a_ as K,aY as Q}from"./@vue-ts87NNlE.js";import"./class-COLQ8iHP.js";import"./pinia-B_HOjTBS.js";import"./vue-router-Bw4qQE88.js";import"./@vueuse-QQdVrKV8.js";import"./xe-utils-DXe260hc.js";import"./@vue-office-GFDCm3nC.js";import"./vue-demi-BEcyFcst.js";import"./vue-RHKPHaPZ.js";import"./axios-B4uVmeYG.js";import"./@x-ui-vue3-CwLx_scX.js";import"./pinia-plugin-persist-J3Q2VqHx.js";import"./vue3-menus-CnNWMJEM.js";import"./vue3-photo-preview-CkWuweRQ.js";import"./vxe-table-QgdefRjh.js";import"./dom-zindex-GlLoxNk1.js";function Z(){return window.getDeviceInfo=e=>JSON.parse(e),C({func:"getInfo"})}const ee={version:"2.4.4",h5:"2.4.33"},te=[{...I(""),titleClass:"w-full  text-xl center ",class:"!h-[90px]",backfill(){const e=u();this.title=e.name}},{formType:"input",leftIcon:"lock",label:"更换密码",value:"",isLink:!0,name:"onChangePassword",readonly:!0,click(){n("onChangePasswordPop","show",!0)}},{...k(),...v("companyId",[],"dymaic"),leftIcon:"cluster-o",name:"companyId",label:"所属组织",async backfill(){const e=u(),t=M(),d={userId:e.userId},{data:g}=await x.get($("/user-company/get-user-companies",d)),l=g.map(a=>({value:a.company.companyId,text:a.company.name}));this.makeSelect(t.companyId,l),this.inlineForm[0].inlineForm[0].confirm=async a=>{n(this.name,"value",a.selectedOptions[0].text),n(this.name,"realValue",a.selectedOptions[0].value),n(this.name,"inlineForm.0.show",!1);const f=O();if(resp.code==200){const h=await Z(),b=D(),w=f.usernameList[0],i={...b,...h,...w,type:"password"};await x.post("/login",i)}}}},{formType:"input",name:"h5",label:"版本信息",readonly:!0,value:"",onMounted(){this.value=ee.h5},inlineForm:[{slot:"button",formType:"button",size:"mini",className:"px-3 yCenter !bg-[#ffab30] text-white rounded-2xl",text:"刷新",click(){location.reload();const e=T();e.tabbar=1}}]},{formType:"input",name:"coreInfo",label:"内核信息",readonly:!0,value:"",os:"",async onMounted(){C({func:"getInfo"}),window.getDeviceInfo=async e=>{const t=JSON.parse(e);this.os=t.os,this.value=t.version}},inlineForm:[{slot:"button",formType:"button",size:"mini",className:"px-3 yCenter !bg-[#ffab30] text-white rounded-2xl",text:"下载 App",click(){n("coreInfo",e=>{e.os=="android"?R("https://www.btosolarman.com/APP/boGuangAPP/prod/boGuang.prop.apk"):A("网页无法下载; ios版, 请到testFlight中更新")})}}]},{...k(),...v("env",[{text:"开发环境",value:"dev"},{text:"生产环境",value:"prod"}]),value:"",realValue:"prod",name:"env",label:"当前环境",isLink:!1,readonly:!0},{formType:"input",label:"隐私政策",value:"",isLink:!0,name:"private",readonly:!0,value:"点击查看",click(){G("https://www.btosolarman.com/APP/boGuangAPP/privacy.txt",this.label)}}],oe=[{...I("修改密码"),name:"onChangePasswordPop",titleClass:"w-full center text-xl",show:!1},{customSlot:"tabs",tab:"",tabs:["原密码修改","验证码修改"],name:"tab"},{formType:"input",name:"phone",label:"手机号码",inputAlign:"left",value:"",required:!0,backfill(){const e=u();this.value=e.phone}},{formType:"input",name:"code",inputAlign:"left",label:"验证码",value:"",required:!0,show:!1,inlineForm:[{slot:"button",formType:"button",size:"mini",className:"px-3 yCenter !bg-[#ffab30] text-white rounded-2xl",text:"获取验证码",async click(){if(this.text.includes("后重新获取")){N(this.text);return}u().phone,n("code",t=>{t.count.start(),this.text=o(()=>t.count.current.seconds?t.count.current.seconds+"s 后重新获取":"获取验证码")})}}],backfill(){this.count=L({time:60*1e3,seconds:!0}),this.hidden=o(()=>!s("tab","tab"))}},{formType:"input",labelClass:"hidden",name:"checkCode",pass:!1,inputAlign:"center",inlineForm:[{slot:"input",formType:"button",size:"mini",className:"px-7  yCenter !bg-[#ffab30] text-white rounded-2xl",text:"校验验证码",async click(){s("code","value"),s("phone","value"),n("checkCode",e=>{console.log(e,333333),e.pass=!0})}}],backfill(){this.hidden=o(()=>!s("tab","tab"))}},{formType:"input",name:"password",label:"原密码",inputAlign:"left",type:"password",value:"",required:!0,show:!1,rightIcon:"closed-eye",clickRightIcon(){this.show=!this.show},backfill(){this.hidden=o(()=>s("tab","tab")&&!s("checkCode","pass")),this.type=o(()=>this.show?"input":"password"),this.rightIcon=o(()=>this.show?"eye-o":"closed-eye")}},{formType:"input",name:"newPassword",label:"新密码",inputAlign:"left",type:"password",value:"",required:!0,show:!1,rightIcon:"closed-eye",clickRightIcon(){this.show=!this.show},backfill(){this.hidden=o(()=>s("tab","tab")&&!s("checkCode","pass")),this.type=o(()=>this.show?"input":"password"),this.rightIcon=o(()=>this.show?"eye-o":"closed-eye")}},{formType:"input",name:"confirmPassword",label:"确认密码",inputAlign:"left",type:"password",value:"",required:!0,show:!1,rightIcon:"closed-eye",clickRightIcon(){this.show=!this.show},backfill(){this.hidden=o(()=>s("tab","tab")&&!s("checkCode","pass")),this.type=o(()=>this.show?"input":"password"),this.rightIcon=o(()=>this.show?"eye-o":"closed-eye")}},{formType:"input",name:"button",labelClass:"!w-1/2 xCenter",valueClass:"!w-1/2 xCenter",inputAlign:"center",inlineForm:[{slot:"label",formType:"button",size:"mini",className:"px-10 yCenter !bg-[#f3f3f3] text-[#232323] rounded-2xl",text:"取消",click(){n("onChangePasswordPop","show",!1)}},{slot:"input",formType:"button",size:"mini",className:"px-10 center !bg-[#ffab30] text-white rounded-2xl",text:"确认",async click(){s("tab","tab")}}]}],se=e=>(K("data-v-48b0b4fd"),e=e(),Q(),e),ae={class:"flex-1 bg-[#fbf9f6]"},ne=se(()=>F("div",{class:"xCenter pt-[10%] text-[20px] text-white bgImg h-[30vh]"},"个人中心",-1)),ie={class:"xCenter mt-8 mx-7"},re={__name:"person",setup(e){const t=U({form:te,modifyForm:oe});T(),E(()=>{B(t,{})});function d(){J.replace("/login")}return(g,l)=>{const a=z,f=V,h=q,b=S,w=P;return y(),_("div",ae,[ne,r(a,{form:p(t).form,class:"pt-3 mx-3 mt-[-15vh]","group-class":"shadowC "},null,8,["form"]),r(b,{show:p(t).modifyForm[0].show,"onUpdate:show":l[0]||(l[0]=i=>p(t).modifyForm[0].show=i),class:"!w-[90%] !mt-[-20%]",round:"",position:"center"},{default:m(()=>[r(a,{form:p(t).modifyForm,"group-class":"shadowC"},{tabs:m(({slot:i})=>[r(h,{class:"flex-1 flex flex-col",active:i.tab,"onUpdate:active":c=>i.tab=c,background:"#f3f3f3","line-width":"80px",color:"#ffab30",swipeable:""},{default:m(()=>[(y(!0),_(H,null,W(i.tabs,c=>(y(),X(f,{title:c,key:c},null,8,["title"]))),128))]),_:2},1032,["active","onUpdate:active"])]),_:1},8,["form"])]),_:1},8,["show"]),F("div",ie,[r(w,{class:"w-full",onClick:d},{default:m(()=>[Y("退出登录")]),_:1})])])}}},Ve=j(re,[["__scopeId","data-v-48b0b4fd"]]);export{Ve as default};
