import{a as w,S as v}from"./vant-BjNCsb4u.js";import{V as y,b as g}from"./@vue-office-GFDCm3nC.js";import{c as _,e as k,v as F,o as x,d as T}from"./index-DoomjHTc.js";import{r as S,aX as r,al as l,N as U,u as o,i as V,aj as p,ak as a,F as $}from"./@vue-ts87NNlE.js";import"./@vant-NmgEisJw.js";import"./vue-demi-BEcyFcst.js";import"./vue-RHKPHaPZ.js";import"./pinia-B_HOjTBS.js";import"./lodash-DhpMPSDc.js";import"./vue-router-Bw4qQE88.js";import"./@vueuse-QQdVrKV8.js";import"./xe-utils-DXe260hc.js";import"./axios-B4uVmeYG.js";import"./@x-ui-vue3-CwLx_scX.js";import"./pinia-plugin-persist-J3Q2VqHx.js";import"./vue3-menus-CnNWMJEM.js";import"./vue3-photo-preview-CkWuweRQ.js";import"./vxe-table-QgdefRjh.js";import"./dom-zindex-GlLoxNk1.js";const z=["src"],B=["src"],c="https://view.officeapps.live.com/op/view.aspx?src=",N="https://view.xdocin.com/view?src=",Y={__name:"previewFile",setup(R){const n=_(),e=n.url.replace("http:","https:"),s=S(!1),m=[[{name:"复制链接",icon:"https://img.icons8.com/?size=100&id=723&format=png&color=000000"},{name:"打开浏览器",icon:"https://img.icons8.com/?size=100&id=53372&format=png&color=000000"},{name:"下载文件",icon:"https://img.icons8.com/?size=100&id=14300&format=png&color=000000"}]];function f(){s.value=!0}function u(t){if(t.name=="打开浏览器"){const i={pdf:e,word:N+e}[F(e)]||c+e;x(i)}else t.name=="复制链接"?T(e):t.name=="下载文件"&&w("功能开发中...");s.value=!1}return k({onRefresh:()=>location.reload(),onClickRight:f}),(t,i)=>{const d=v;return r(),l($,null,[U(d,{show:o(s),"onUpdate:show":i[0]||(i[0]=h=>V(s)?s.value=h:null),title:"下载文件或复制链接",options:m,onSelect:u},null,8,["show"]),t.$viewFileType(o(e))=="word"?(r(),p(o(y),{key:0,class:"flex-1",src:o(e)},null,8,["src"])):a("",!0),t.$viewFileType(o(e))=="excel"?(r(),l("iframe",{key:1,class:"flex-1",src:c+o(e),"update-title":!1},null,8,z)):a("",!0),t.$viewFileType(o(e))=="ppt"?(r(),l("iframe",{key:2,class:"flex-1",src:c+o(e),"update-title":!1},null,8,B)):a("",!0),o(n).type=="pdf"||t.$viewFileType(o(e))=="pdf"?(r(),p(o(g),{key:3,class:"flex-1",src:o(e)},null,8,["src"])):a("",!0)],64)}}};export{Y as default};
